[properties]
name=AlienVault Agent log
description=Parses the Agent log to search for errors.
category=alienvault,platform
profiles=Sensor:>4.0
type=command
command=sed '/Connected to ALIENVAULT-SERVER/q' /var/log/alienvault/agent/agent.log  | grep "ERROR" | grep "Can't connect to server, retrying" | wc -l; sed '/Connected to ALIENVAULT-SERVER/q' /var/log/alienvault/agent/agent.log | grep -v "connecting to server" | grep -v "connect to server"; sed -n '/Connected to ALIENVAULT-SERVER/,$ p' /var/log/alienvault/agent/agent.log
raw_limit=2000

[Number of server connection errors before connecting to server]
pattern=^(\d)$
conditions=@int@:<10
warning=Too many connection errors found before connecting to server
advice=It is necessary for the agent to establish a correct connection with a server

[Errors in agent.log]
pattern=Alienvault\-Agent\[ERROR\]\:\s(.*)$
conditions=@string@:==""
fail_if_empty=False
severity=High
warning=Error(s) were found in the AlienVault Agent log file
advice=Errors in the AlienVault Agent log file may be a symptom of misconfigured plugins, unavailable data sources or missing packages, among others.
