[properties]
name=Agent rsyslog configuration files integrity
description=Check the integrity of the default Agent rsyslog configuration files.
category=alienvault
type=command
command=diff -burq /etc/rsyslog.d/ /usr/share/alienvault-plugins/d_clean/rsyslog/

[Default agent rsyslog files integrity]
pattern=\/\/((\S+\.conf))\s+differ$
conditions=@info@;@string@:==""
fail_if_empty=False
warning=Some of the default Agent rsyslog files have been modified
advice=Modifying the default Agent rsyslog files is not supported. Please contact support and/or restore the plugin package.

[Default agent rsyslog files installed]
pattern=^Only\sin\s\/usr\/share\/alienvault\-plugins\/d\_clean\/rsyslog\/\:\s((\S+))$
conditions=@info@;@string@:==""
fail_if_empty=False
warning=Some of the default Agent rsyslog files have not been properly installed
advice=Your system does not have all the default Agent rsyslog files. Please contact support and/or restore the plugin package.