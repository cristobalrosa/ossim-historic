;; Firewall-1 NG R60 (fw1ngr60)
;; plugin_id: 1504
;; 
;; $Id $
;;

[DEFAULT]
plugin_id=1504

[config]
type=detector
enable=yes

source=log
location=/var/log/ossim/fw1.log

# create log file if it does not exists,
# otherwise stop processing this plugin
create_file=false

#This process is started by fw1-loggrabber
process=fw1-loggrabber
start=yes
stop=no
startup=/opt/fw1-loggrabber-1.11.1-linux/fw1-loggrabber -c /opt/fw1-loggrabber-1.11.1-linux/fw1-loggrabber.conf -l /opt/fw1-loggrabber-1.11.1-linux/lea.conf

shutdown=kill -9 `pidof fw1-loggrabber`

# use {translate($n)} for translations
[translation]
ACCEPT=1
REJECT=2
DROP=3
DENY=3
Inbound=4
Outbound=5
_DEFAULT_=99

[fw1ngr60-generic]
event_type=event
regexp=loc=\d+\|time=(\d+\-\d+\-\d+\s+\d+:\d+:\d+)\|action=(\w+)\|orig=(\d+\.\d+\.\d+\.\d+)\|i\/f_dir=(\w+)\|i\/f_name=([\w\-]+)\|has_accounting=(\d+)\|uuid=<([\S,]+)>\|product=([a-zA-Z0-9\-&\s]+)\|__policy_id_tag=product=[a-zA-Z0-9\-&\s]+\[db_tag=\{([\S\-]+)\};mgmt=(\w+);date=(\d+);policy_name=(\w+)\]\|src=(\d+\.\d+\.\d+\.\d+)\|s_port=(\d+)\|dst=(\d+\.\d+\.\d+\.\d+)\|service=(\d+)\|proto=(\w+)\|rule=(\d+)
date={$1}
plugin_sid={translate($2)}
src_ip={$13}
dst_ip={$15}
protocol={$17}
src_port={$14}
dst_port={$16}
userdata4=Action: {$2}, firewall: {$3}, policy_name: {$12}, rule: {$18}, if_name: {$5}, product: {$8}, uuid: {$7}




