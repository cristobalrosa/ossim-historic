;; apache
;; plugin_id: 1501
;; 
;; $Id: apache.cfg,v 1.1 2007/04/23 17:02:55 llicour Exp $
;;

[DEFAULT]
plugin_id=1501

[config]
type=detector
enable=yes

source=log
location=/var/log/%(process)s/access.log

# create log file if it does not exists,
# otherwise stop processing this plugin
create_file=false

process=apache2     ; change by apache|httpd|etc.
start=yes   ; launch plugin process when agent starts
stop=no     ; shutdown plugin process when agent stops
startup=/etc/init.d/%(process)s start
shutdown=/etc/init.d/%(process)s stop

# list of sids (comma separated) to be excluded by the detector
exclude_sids=200

[apache-access]
# 127.0.0.1 - - [28/Feb/2006:07:32:47 +0000] "GET /acidbase/ HTTP/1.1" 404 282
# "-" "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.0.1)
# Gecko/Debian-1.8.0.1-5 Epiphany/1.8.5"
event_type=event
regexp=(\IPV4) (\S+) (\S+) \[(?P<date>(\d\d)\/(\w\w\w)\/(\d\d\d\d):(\d\d):(\d\d):(\d\d)).+"(?P<info>.+)" (?P<sid>\d+) (\S+)
src_ip={$1}
date={normalize_date($date)}
plugin_sid={$sid}
#dst_ip=127.0.0.1
#dst_port=80
log={$info}

