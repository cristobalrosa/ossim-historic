;; nagios
;; type: detector
;; plugin_id: 1525
;;
;; $Id: nagios.cfg,v 1.1 2007/04/23 17:02:54 llicour Exp $
;;


[DEFAULT]
plugin_id=1525

[config]
type=detector
enable=yes

source=log
location=/var/log/nagios/nagios.log

process=nagios
start=yes
stop=no
startup=/etc/init.d/nagios start
shutdown=/etc/init.d/nagios stop


[translation]
UP=1
DOWN=2
OK=3
WARNING=4
CRITICAL=5

[nagios-host-alert]
# [1164180397] HOST ALERT: golgotha;DOWN;SOFT;2;CRITICAL - Host Unreachable
# (192.168.6.64)
event_type=event
regexp=\[(\d+)\] HOST ALERT: ([\w\-]+)\;(DOWN|UP)\;(HARD|SOFT)\;\d\;(.+)
date={normalize_date($1)}
src_ip={resolv($2)}
plugin_sid={translate($3)}
#description=Host {$2} reported status {$3} with {$5}
data={$5}

[nagios-service-alert]
# [1164179890] SERVICE ALERT: golgotha;PING;OK;SOFT;2;PING OK - 
# Packet loss = 0%, RTA = 14.15 ms
event_type=event
regexp=\[(\d+)\] SERVICE ALERT: ([^;]+)\;([^;]+)\;(CRITICAL|WARNING|OK)\;(SOFT|HARD)\;\d\;(.+)
date={normalize_date($1)}
src_ip={resolv($2)}
plugin_sid={translate($4)}
#description=Service {$3} on {$2} reported status {$4} with {$6}
data={$6}

