;; cisco-pix
;; plugin_id: 1514
;; 
;; $Id: cisco-pix.cfg,v 1.1 2007/06/26 13:13:56 dvgil Exp $
;;
;; TODO: test plugin with the following sample logs:
;;       http://www.ossec.net/wiki/index.php/Cisco_PIX
;;

[DEFAULT]
plugin_id=1514

[config]
type=detector
enable=yes

source=log
location=/var/log/syslog
create_file=false

process=
start=no
stop=no
startup=
shutdown=

[cisco-pix-rule1]
# May 20 2006 01:00:00 saravana: %PIX-6-302013: 
# Built outbound TCP connection 31174132 
# for outside:212.37.223.35/80 (212.37.223.35/80) 
# to inside:192.168.1.1/52648 (64.211.150.166/54508)
#
# Mar 29 2004 09:56:03: %PIX-6-106015:
# Deny TCP (no connection)
# from 192.168.0.2/2796 to 192.168.80.1/1719
# flags SYN ACK on interface inside
#
# Jun 26 14:49:15 ossim-devel: %PIX-6-302016: 
# Teardown UDP connection 1042068 
# for outside:192.168.20.45/53 to inside:192.168.20.208/37989 
# duration 0:02:10 bytes 185
event_type=event
regexp=(?P<date>\SYSLOG_DATE)\s*(?P<sensor>[^:]*): %PIX-\d-(?P<sid>\d+):.*?(from|src|for inside|for outside|src inside|src outside).*?(?P<src>\IPv4)(\/(?P<sport>\d+))?.*?(dst|to inside|to outside|dst inside|dst outside).*?(?P<dst>\IPv4)(\/(?P<dport>\d+))?
date={$date}
sensor={$sensor}
plugin_sid={$sid}
src_ip={$src}
src_port={$sport}
dst_ip={$dst}
dst_port={$dport}

