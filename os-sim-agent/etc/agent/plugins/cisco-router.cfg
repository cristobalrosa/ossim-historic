;; cisco-router
;; plugin_id: 1510
;; 
;; $Log: cisco-router.cfg,v $
;; Revision 1.1  2007/04/23 17:02:54  llicour
;; reorganize /etc
;;
;; Revision 1.1  2006/11/07 14:42:29  dvgil
;; Part of cisco-router plugin migrated from the old agent. Still incomplete
;;

[DEFAULT]
plugin_id=1510

[config]
type=detector
enable=yes

source=log
location=/var/log/messages

# create log file if it does not exists,
# otherwise stop processing this plugin
create_file=false

process=
start=no
stop=no
startup=/sbin/syslogd -r -m 0
shutdown=killall -9 syslogd

# use {translate($n)} for translations
[translation]
RCMD-4-RSHPORTATTEMPT=      1
CLEAR-5-COUNTERS=           2
LINEPROTO-5-UPDOWN=         3

[cisco-router-rule1]
# Nov  7 12:57:04 192.168.101.25 50779: Nov  7 12:57:59: %SEC-6- 
# IPACCESSLOGP: list 103 denied udp 192.168.101.114(123) ->  
# 192.168.99.154(123), 5 packets
event_type=event
regexp=(\w+\s+\d{1,2}\s+\d\d:\d\d:\d\d)\s+(\S+)\s+\S+:.*?(\w+-(\d)-\w+).*?(\S+)\s+(\d+\.\d+\.\d+\.\d+)\((\d+)\).*?(\d+\.\d+\.\d+\.\d+)\((\d+)\)
date={normalize_date($1)}
sensor={$2}
plugin_sid={translate($3)}
protocol={$5}
src_ip={$6}
src_port={$7}
dst_ip={$8}
dst_port={$9}
data=severity: {$4}


