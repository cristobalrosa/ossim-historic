;; iptables
;; plugin_id: 1503
;; 
;; $Log: iptables.cfg,v $
;; Revision 1.3  2006/11/06 15:43:07  dvgil
;; s/SyslogDate/normalize_date/
;;
;; Revision 1.2  2006/11/03 09:47:38  dvgil
;; convert the plugin to use a translation table and only one rule
;;
;; Revision 1.1  2006/10/31 08:45:40  dvgil
;; first iptables plugin commit
;;
;;

[DEFAULT]
plugin_id=1503

[config]
type=detector
enable=yes

source=log
location=/var/log/syslog

# create log file if it does not exists,
# otherwise stop processing this plugin
create_file=false

process=
start=no
stop=no
startup=
shutdown=

# use {translate($n)} for translations
[translation]
ACCEPT=1
REJECT=2
DROP=3
DENY=3
Inbound=4
Outbound=5

[iptables-generic]
# Oct 31 08:59:25 M2600001 kernel: RULE 0 -- ACCEPT IN= OUT=lo SRC=127.0.0.1
# DST=127.0.0.1 LEN=60 TOS=0x00 PREC=0x00 TTL=64 ID=8437 DF PROTO=TCP SPT=57275
# DPT=836 SEQ=2806649400 ACK=0 WINDOW=32767 RES=0x00 SYN URGP=0
event_type=event
regexp=(\S+\s+\d+\s+\d\d:\d\d:\d\d)\s+(\S*) (\S*):.*?(\S+)\s+IN=(\S*) OUT=(\S*) \S+ SRC=(\S+) DST=(\S+) LEN=(\d+) \S+ \S+ TTL=(\d+) .*? PROTO=(\S*) SPT=(\d*) DPT=(\d*)
date={normalize_date($1)}
plugin_sid={translate($4)}
src_ip={$7}
dst_ip={$8}
protocol={$11}
src_port={$12}
dst_port={$13}
data=server: {$2}, sourcewpid: {$3}, in: {$5}, out: {$6}, len: {$9}, ttl: {$10}


