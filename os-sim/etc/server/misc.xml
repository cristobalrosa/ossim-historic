<?xml version='1.0' encoding='UTF-8' ?>

<!-- Info Gathering, detect when a possible intruder try to get SMTP users using VRFY command

We need Snort rule 5000001

alert tcp any any -> any 25 (msg:"SMTP vrfy user"; flow:to_server,established; content:"vrfy"; nocase; sid:5000001; rev:6;)
insert into plugin_sid values (1001, 5000001, null, null, 2, 3, "SMTP vrfy user");
-->

<directive id="27010" name="Username gathering at SMTP server DST_IP" priority="3">
	<rule type="detector" name="Bruteforce against " reliability="3" time_out="10"
	    occurrence="5" from="ANY" to="ANY" port_from="ANY"
	    port_to="25" plugin_id="1001" plugin_sid="5000001" protocol="ANY">
		<rules>
			<rule type="detector" name="Username gathering at SMTP server DST_IP" reliability="+3" time_out="15"
			    occurrence="10" from="1:SRC_IP" to="1:DST_IP" port_from="ANY"
			    port_to="25" plugin_id="1001" plugin_sid="5000001" protocol="ANY">
			    <rules>
			    <rule type="detector" name="Username gathering at SMTP server DST_IP" reliability="+5" time_out="30"
				    occurrence="30" from="1:SRC_IP" to="1:DST_IP" port_from="ANY"
				    port_to="25" plugin_id="1001" plugin_sid="5000001" protocol="ANY"/>
			    </rules>
			</rule>
		</rules>
	</rule>
</directive>

