;; sudo
;; plugin_id: 1573
;; type: detector 
;; description: This checks the Sonicwall logs
;;              
;; URL: http://www.sudo.ws
;;

[DEFAULT]
plugin_id=1573

[config]
type=detector
enable=yes

source=log
location=/var/log/syslog

# create log file if it does not exists, 
# otherwise stop processing this plugin
create_file=false

process=
start=no   
stop=no
startup=
shutdown=


## rules

[Rule-1 sonicwall ]
#Jan  3 13:45:36 192.168.5.1 id=firewall sn=000SERIAL time="2007-01-03 14:48:06" fw=1.1.1.1 pri=6 c=262144 m=98 msg="Connection Opened" n=23419 src=2.2.2.2:36701:WAN dst=1.1.1.1:50000:WAN proto=tcp/50000
#Jan  3 13:45:37 192.168.5.1 id=firewall sn=000SERIAL time="2007-01-03 14:48:07" fw=1.1.1.1 pri=6 c=1024 m=537 msg="Connection Closed" n=567996 src=192.168.4.10:27577:WAN dst=192.168.5.10:53:LAN proto=tcp/dns sent=257 rcvd=242
event_type=event
regexp="id=(?P<id>\S+)\s+.*?time="(?P<date>\d{4}-\d\d-\d\d \d\d:\d\d:\d\d)"\s+fw=(?P<sensor>\IPV4)\s+pri=(?P<priority>\d+).*?m=(?P<type>\d+).*?src=(?P<source>\IPV4):(?P<src_port>\PORT).*?dst=(?P<destination>\IPV4):(?P<dst_port>\d+).*proto=(?P<protocol>\w+).*"
date={normalize_date($date)}
plugin_sid={$type}
sensor={$sensor}
src_ip={$source}
dst_ip={$destination}
src_port={$src_port}
dst_port={$dst_port}
protocol={normalize_protocol($protocol)}
userdata1={$id}

