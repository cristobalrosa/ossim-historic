;; whois
;; type: monitor
;; plugin_id: 2010
;;
;;


[DEFAULT]
plugin_id=2010

[config]
type=monitor
enable=yes

source=command
location=

process=
start=no
stop=no
startup=
shutdown=

# use {translate($n)} for translations
[translation]
#Afghanistan
AF=0
#Albania
AL=2
#Algeria
DZ=3
#American Samoa
AS=4
#Andorra
AD=5
#Angola
AO=6
#Anguilla
AI=7
#Antarctica
AQ=8
#Antigua and Barbuda
AG=9
#Argentina
AR=10
#Armenia
AM=11
#Aruba
AW=12
#Australia
AU=14
#Austria
AT=15
#Azerbaijan
AZ=16
#Bahrain
BH=17
#Baker Island
UM=18
#Bangladesh
BD=19
#Barbados
BB=20
#Belarus
BY=22
#Belgium
BE=23
#Belize
BZ=24
#Benin
BJ=25
#Bermuda
BM=26
#Bhutan
BT=27
#Bolivia
BO=28
#Bosnia and Herzegovina
BA=29
#Botswana
BW=30
#Brazil
BR=31
#British Indian Ocean Territory
IO=32
#British Virgin Islands
VG=33
#Brunei
BN=34
#Bulgaria
BG=35
#Burkina Faso
BF=36
#Burma
MM=37
#Burundi
BI=38
#Cambodia
KH=39
#Cameroon
CM=40
#Canada
CA=41
#Cape Verde
CV=42
#Cayman Islands
KY=43
#Central African Republic
CF=44
#Chad
TD=45
#Chile
CL=46
#China
CN=47
#Christmas Island
CX=48
#Cocos (Keeling) Islands
CC=50
#Colombia
CO=51
#Comoros
KM=52
#Cook Islands
CK=53
#Costa Rica
CR=55
#Cote d Ivoire
CI=56
#Croatia
HR=57
#Cuba
CU=58
#Cyprus
CY=59
#Czech Republic
CZ=60
#Democratic Republic of the Congo
CD=61
#Denmark
DK=62
#Djibouti
DJ=64
#Dominica
DM=65
#Dominican Republic
DO=66
#East Timor
TL=67
#Ecuador
EC=68
#Egypt
EG=69
#El Salvador
SV=70
#Equatorial Guinea
GQ=71
#Eritrea
ER=72
#Estonia
EE=73
#Ethiopia
ET=74
#Falkland Islands
FK=75
#Faroe Islands
FO=76
#Fiji
FJ=77
#Finland
FI=78
#France
FR=79
#French Guiana
GF=80
#French Polynesia
PF=81
#Gabon
GA=82
#Georgia
GE=84
#Germany
DE=85
#Ghana
GH=86
#Gibraltar
GI=87
#Greece
GR=88
#Greenland
GL=89
#Grenada
GD=90
#Guadeloupe
GP=91
#Guam
GU=92
#Guatemala
GT=93
#Guinea
GN=95
#Guinea-Bissau
GW=96
#Guyana
GY=97
#Haiti
HT=98
#Holy See
VA=99
#Honduras
HN=100
#Hong Kong
HK=101
#Howland Island
UM=102
#Hungary
HU=103
#Iceland
IS=104
#India
IN=105
#Indonesia
ID=106
#Iran
IR=107
#Iraq
IQ=108
#Ireland
IE=109
#Israel
IL=111
#Italy
IT=112
#Jamaica
JM=113
#Jan Mayen
SJ=114
#Japan
JP=115
#Jarvis Island
UM=116
#Johnston Atoll
UM=118
#Jordan
JO=119
#Kazakhstan
KZ=121
#Kenya
KE=122
#Kingman Reef
UM=123
#Kiribati
KI=124
#Korea, North
KP=125
#Korea, South
KR=126
#Kuwait
KW=127
#Kyrgyzstan
KG=128
#Laos
LA=129
#Latvia
LV=130
#Lebanon
LB=131
#Lesotho
LS=132
#Liberia
LR=133
#Libya
LY=134
#Liechtenstein
LI=135
#Lithuania
LT=136
#Luxembourg
LU=137
#Macau
MO=138
#Macedonia
MK=139
#Madagascar
MG=140
#Malawi
MW=141
#Malaysia
MY=142
#Maldives
MV=143
#Mali
ML=144
#Malta
MT=145
#Marshall Islands
MH=146
#Martinique
MQ=147
#Mauritania
MR=148
#Mauritius
MU=149
#Mayotte
YT=150
#Mexico
MX=151
#Micronesia
FM=152
#Midway Islands
UM=153
#Moldova
MD=154
#Monaco
MC=155
#Mongolia
MN=156
#Montserrat
MS=158
#Morocco
MA=159
#Mozambique
MZ=160
#Namibia
NA=161
#Nauru
NR=162
#Nepal
NP=163
#Netherlands
NL=164
#Netherlands Antilles
AN=165
#New Caledonia
NC=166
#New Zealand
NZ=167
#Nicaragua
NI=168
#Niger
NE=169
#Nigeria
NG=170
#Niue
NU=171
#Norfolk Island
NF=172
#Northern Mariana Islands
MP=173
#Norway
NO=174
#Oman
OM=175
#Pakistan
PK=176
#Palau
PW=177
#Panama
PA=178
#Papua New Guinea
PG=179
#Paraguay
PY=180
#Peru
PE=182
#Philippines
PH=183
#Pitcairn Islands
PN=184
#Poland
PL=185
#Portugal
PT=186
#Puerto Rico
PR=187
#Qatar
QA=188
#Republic of the Congo
CG=189
#Reunion
RE=190
#Romania
RO=191
#Russia
RU=192
#Rwanda
RW=193
#Saint Helena
SH=194
#Saint Kitts and Nevis
KN=195
#Saint Lucia
LC=196
#Saint Pierre and Miquelon
PM=197
#Saint Vincent and the Grenadines
VC=198
#Samoa
WS=199
#San Marino
SM=200
#Sao Tome and Principe
ST=201
#Saudi Arabia
SA=202
#Senegal
SN=203
#Serbia
CS=204
#Seychelles
SC=205
#Sierra Leone
SL=206
#Singapore
SG=207
#Slovakia
SK=208
#Slovenia
SI=209
#Solomon Islands
SB=210
#Somalia
SO=211
#South Africa
ZA=212
#South Georgia
GS=213
#Spain
ES=214
#Sri Lanka
LK=215
#Sudan
SD=216
#Suriname
SR=217
#Svalbard
SJ=218
#Swaziland
SZ=219
#Sweden
SE=220
#Switzerland
CH=221
#Syria
SY=222
#Taiwan
TW=223
#Tajikistan
TJ=224
#Tanzania
TZ=225
#Thailand
TH=226
#The Bahamas
BS=227
#The Gambia
GM=228
#Togo
TG=229
#Tokelau
TK=230
#Tonga
TO=231
#Trinidad and Tobago
TT=232
#Tunisia
TN=233
#Turkey
TR=234
#Turkmenistan
TM=235
#Turks and Caicos Islands
TC=236
#Tuvalu
TV=237
#Uganda
UG=238
#Ukraine
UA=239
#United Arab Emirates
AE=240
#United Kingdom
GB=241
#United States of America
US=242
#Uruguay
UY=243
#Uzbekistan
UZ=244
#Vanuatu
VU=245
#Venezuela
VE=246
#Vietnam
VN=247
#Virgin Islands
VI=248
#Wake Island
UM=249
#Wallis and Futuna
WF=250
#Western Sahara
EH=252
#Yemen
YE=253
#Zambia
ZM=254
#Zimbabwe
ZW=255

## you can use the following variables to build your monitor queries
## this variables are part of the watch-rule received by the server
#   - {$plugin_id}
#   - {$plugin_sid}
#   - {$condition}
#   - {$value}
#   - {$port_from}
#   - {$port_to}
#   - {$interval}
#   - {$from}
#   - {$to}
#   - {$absolute}

## rule variables:
#   - query: request to the monitor
#   - sid: 'any', a digit or a list of digits (n,m,o). Used to match the rule
#   - pattern: check info returned by the monitor
#   - result: the final result that will be sent back to the server

[whois-country]
#Country:    US
query="whois {$from}"
sid=1
regexp="Country:\s+(\w{2})"
result={translate($1)}
