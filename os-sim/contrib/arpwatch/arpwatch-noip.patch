--- arpwatch-2.1a11/arpwatch.c.orig	2004-04-27 11:27:20.000000000 +0200
+++ arpwatch-2.1a11/arpwatch.c	2004-04-27 11:34:00.000000000 +0200
@@ -165,7 +165,7 @@
 main(int argc, char **argv)
 {
 	register char *cp;
-	register int op, pid, snaplen, timeout, linktype, status;
+	register int op, pid, snaplen, timeout, linktype, status, noip=0;
 #ifdef TIOCNOTTY
 	register int fd;
 #endif
@@ -191,7 +191,7 @@
 	interface = NULL;
 	rfilename = NULL;
 	pd = NULL;
-	while ((op = getopt(argc, argv, "df:i:n:Nr:u:e:s:")) != EOF)
+	while ((op = getopt(argc, argv, "df:i:n:wNr:u:e:s:")) != EOF)
 		switch (op) {
 
 		case 'd':
@@ -252,6 +252,9 @@
 				usage();
 			}
 			break;
+		case 'w':
+			++noip;
+			break;
 
 		default:
 			usage();
@@ -272,12 +275,18 @@
 			exit(1);
 		}
 
+		if(noip){
+			/* Be able to sniff on interfaces without address */
+			net = 0;
+			netmask = 0;
+		} else {
 		/* Determine network and netmask */
 		if (pcap_lookupnet(interface, &net, &netmask, errbuf) < 0) {
 			(void)fprintf(stderr, "%s: bad interface %s: %s\n",
 			    prog, interface, errbuf);
 			exit(1);
 		}
+		}
 
 		/* Drop into the background if not debugging */
 		if (!debug) {
@@ -804,7 +813,7 @@
 	extern char version[];
 
 	(void)fprintf(stderr, "Version %s\n", version);
-	(void)fprintf(stderr, "usage: %s [-dN] [-f datafile] [-i interface]"
+	(void)fprintf(stderr, "usage: %s [-dNw] [-f datafile] [-i interface]"
 	    " [-n net[/width]] [-r file] [-u username]"
 	    " [-e username] [-s username]\n", prog);
 	exit(1);
