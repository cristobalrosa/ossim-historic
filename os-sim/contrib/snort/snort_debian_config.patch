diff -Naur snort-2.3.2.orig/debian/rules snort-2.3.2/debian/rules
--- snort-2.3.2.orig/debian/rules	2005-03-29 10:19:57.824158904 +0200
+++ snort-2.3.2/debian/rules	2005-03-29 10:52:58.497050856 +0200
@@ -114,6 +114,7 @@
 	install -m 755 -o root -g root `pwd`/debian/snort.cron.daily $(TMP)/snort-common/etc/cron.daily/5snort
 	install -m 755 -o root -g root `pwd`/debian/my/snort-stat $(TMP)/snort-common/usr/sbin/
 	install -m 644 -o root -g root `pwd`/etc/snort.conf $(TMP)/snort-common/etc/snort/
+	install -m 644 -o root -g root `pwd`/etc/spade.conf $(TMP)/snort-common/etc/snort/
 	install -m 644 -o root -g root `pwd`/etc/unicode.map $(TMP)/snort-common/etc/snort/
 	install -m 644 -o root -g root `pwd`/etc/threshold.conf $(TMP)/snort-common/etc/snort/
 
diff -Naur snort-2.3.2.orig/etc/snort.conf snort-2.3.2/etc/snort.conf
--- snort-2.3.2.orig/etc/snort.conf	2005-03-29 10:34:57.865331848 +0200
+++ snort-2.3.2/etc/snort.conf	2005-03-29 11:02:39.772683528 +0200
@@ -543,6 +543,9 @@
 # output database: log, mssql, dbname=snort user=snort password=test
 # output database: log, oracle, dbname=snort user=snort password=test
 
+# OSSIM output example:
+#output database: alert, mysql, user=root password=ossim dbname=snort host=localhost sensor_name=replace_with_sensor_ip logfile=alert
+
 # unified: Snort unified binary format alerting and logging
 # -------------------------------------------------------------
 # The unified output plugin provides two new formats for logging and generating
@@ -696,19 +699,23 @@
 
 include $RULE_PATH/nntp.rules
 include $RULE_PATH/other-ids.rules
-# include $RULE_PATH/web-attacks.rules
-# include $RULE_PATH/backdoor.rules
-# include $RULE_PATH/shellcode.rules
-# include $RULE_PATH/policy.rules
-# include $RULE_PATH/porn.rules
-# include $RULE_PATH/info.rules
-# include $RULE_PATH/icmp-info.rules
-# include $RULE_PATH/virus.rules
-# include $RULE_PATH/chat.rules
-# include $RULE_PATH/multimedia.rules
-# include $RULE_PATH/p2p.rules
+include $RULE_PATH/web-attacks.rules
+include $RULE_PATH/backdoor.rules
+include $RULE_PATH/shellcode.rules
+include $RULE_PATH/policy.rules
+include $RULE_PATH/porn.rules
+include $RULE_PATH/info.rules
+include $RULE_PATH/icmp-info.rules
+include $RULE_PATH/virus.rules
+include $RULE_PATH/chat.rules
+include $RULE_PATH/multimedia.rules
+include $RULE_PATH/p2p.rules
 include $RULE_PATH/experimental.rules
 
+## Bleeding Snort rules
+## http://www.bleedingsnort.com/bleeding-all.rules
+# include $RULE_PATH/bleeding-all.rules
+
 # Include any thresholding or suppression commands. See threshold.conf in the
 # <snort src>/etc directory for details. Commands don't necessarily need to be
 # contained in this conf, but a separate conf makes it easier to maintain them. 
diff -Naur snort-2.3.2.orig/etc/spade.conf snort-2.3.2/etc/spade.conf
--- snort-2.3.2.orig/etc/spade.conf	2005-03-29 10:34:57.680359968 +0200
+++ snort-2.3.2/etc/spade.conf	2005-03-29 10:52:42.188530128 +0200
@@ -3,7 +3,7 @@
 # include it in your snort config file or put lines of this form in it
 
 # set this to a directory Spade can read and write to store its files
-var SPADEDIR .
+var SPADEDIR /var/log/snort/
 
 # see the Usage.Spade file for the full meaning of and all the options
 #   available for all these lines
@@ -21,7 +21,7 @@
 #   connecting to the larger network at the point Spade is running.
 # It is important to configure this line.
 # Your networks should be like [10.0.0.0/8,192.168.0.0/16] or space separated
-preprocessor spade-homenet: any
+#preprocessor spade-homenet: 192.168.1.0/24
 
 # Turn on some detectors with "spade-detect" lines.  Each of these enables
 #   a cetain type of detector for a certain type of packet.  If you start to
@@ -30,46 +30,70 @@
 #   your detectors these that you care least about.
 #        These detect packets going to seemingly closed dest ports
 #            You can add thresh=N to override the default reporting threshold.
-preprocessor spade-detect: type=closed-dport tcpflags=synonly wait=3
-preprocessor spade-detect: type=closed-dport tcpflags=weird thresh=0.5
+#
+#
+#  Closed Dest Ports
+preprocessor spade-detect: type=closed-dport Xsports=80,443 tcpflags=synonly wait=2
+preprocessor spade-detect: type=closed-dport Xsports=53,137,138,139 proto=udp wait=2
+#  Rare but Open Dst Used
+preprocessor spade-detect: type=closed-dport Xsports=80,443 Xdports=80,443 tcpflags=synonly revwaitrpt wait=2
+preprocessor spade-detect: type=closed-dport Xsports=53,137,138,139 proto=udp revwaitrpt wait=2
+#preprocessor spade-detect: type=closed-dport tcpflags=weird thresh=0.5
 #preprocessor spade-detect: type=closed-dport tcpflags=synack 
 #preprocessor spade-detect: type=closed-dport tcpflags=established 
 #preprocessor spade-detect: type=closed-dport tcpflags=teardown 
-#preprocessor spade-detect: type=closed-dport proto=udp wait=5
 #preprocessor spade-detect: type=closed-dport to=nothome tcpflags=synonly wait=5
 #preprocessor spade-detect: type=closed-dport to=nothome tcpflags=weird 
 #preprocessor spade-detect: type=closed-dport to=nothome tcpflags=synack 
 #preprocessor spade-detect: type=closed-dport to=nothome tcpflags=established 
 #preprocessor spade-detect: type=closed-dport to=nothome tcpflags=teardown 
 #preprocessor spade-detect: type=closed-dport to=nothome proto=udp wait=7
-#        These detect packets going to a seemingly non-live IP
-#preprocessor spade-detect: type=dead-dest tcpflags=synonly wait=2
-preprocessor spade-detect: type=dead-dest tcpflags=weird wait=2
-preprocessor spade-detect: type=dead-dest tcpflags=synack wait=2
-#preprocessor spade-detect: type=dead-dest tcpflags=setup wait=2
-preprocessor spade-detect: type=dead-dest tcpflags=established wait=5
-preprocessor spade-detect: type=dead-dest tcpflags=teardown wait=2
-preprocessor spade-detect: type=dead-dest proto=udp wait=2
+
+
+#  These detect packets going to a seemingly non-live IP
+#
+#
+preprocessor spade-detect: type=dead-dest Xdports=80,443 tcpflags=synack wait=2
+preprocessor spade-detect: type=dead-dest proto=udp Xsports=53 wait=2
 preprocessor spade-detect: type=dead-dest proto=icmp icmptype=noterr wait=2
+#preprocessor spade-detect: type=dead-dest tcpflags=weird wait=2
+#preprocessor spade-detect: type=dead-dest tcpflags=setup wait=2
+#preprocessor spade-detect: type=dead-dest tcpflags=synonly wait=2
+#preprocessor spade-detect: type=dead-dest tcpflags=established wait=5
+#preprocessor spade-detect: type=dead-dest tcpflags=teardown wait=2
 #preprocessor spade-detect: type=dead-dest proto=icmp icmptype=err wait=2
+
+
+
 #        These detect unusual use of a dest port by a source IP
 #            You can add thresh=N to override the default reporting threshold.
-#preprocessor spade-detect: type=odd-dport proto=tcp wait=2
-#preprocessor spade-detect: type=odd-dport proto=udp wait=5
+#
+#  Source used Odd Dest Port
+preprocessor spade-detect: type=odd-dport proto=tcp wait=2
+preprocessor spade-detect: type=odd-dport proto=udp Xsports=53,137,138,139 wait=2
 #preprocessor spade-detect: type=odd-dport from=nothome proto=tcp
 #preprocessor spade-detect: type=odd-dport from=nothome proto=udp
+
+
 #        These detect ICMP packets with an unusual type and code
 #            You can add thresh=N to override the default reporting threshold.
+#
+#
 preprocessor spade-detect: type=odd-typecode
 preprocessor spade-detect: type=odd-typecode to=nothome
+
+
 #        These detect unusual connections to a dest IP by a source IP when the
 #            dest port has predictable dest IPs
 #            You can add thresh=N to override the default reporting threshold.
-#preprocessor spade-detect: type=odd-port-dest proto=tcp Xdports=80
-#preprocessor spade-detect: type=odd-port-dest proto=udp Xdports=80
+#
+#   Source Used Odd Dest For Port
+preprocessor spade-detect: type=odd-port-dest proto=tcp Xdports=80,443
+preprocessor spade-detect: type=odd-port-dest proto=udp Xsports=53,137,138,139
 #preprocessor spade-detect: type=odd-port-dest from=nothome proto=tcp Xdports=80
 #preprocessor spade-detect: type=odd-port-dest from=nothome proto=udp Xdports=80
 
+
 # This line causes Spade to adjust the reporting threshold for a given
 #   detector automatically; repeat it for each detector that you want to apply
 #   it to
diff -Naur snort-2.3.2.orig/debian/snort-common.conffiles snort-2.3.2/debian/snort-common.conffiles
--- snort-2.3.2.orig/debian/snort-common.conffiles      2005-04-21 12:49:52.436338144 +0200
+++ snort-2.3.2/debian/snort-common.conffiles   2005-04-21 12:51:08.430785232 +0200
@@ -2,3 +2,4 @@
 /etc/snort/snort.conf
 /etc/snort/unicode.map
 /etc/snort/threshold.conf
+/etc/snort/spade.conf
