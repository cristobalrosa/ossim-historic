<?php

require_once 'ossim_db.inc';

class Incident_vulnerability {

    var $id;
    var $incident_id;
    var $ip;
    var $port;
    var $nessus_id;
    var $risk;
    var $description;

    function Incident_vulnerability ($id, $incident_id, $ip, $port, $nessus_id, $risk, $description)
    {
        $this->id           = intval($id);
        $this->incident_id  = intval($incident_id);
        $this->ip           = $ip;
        $this->port         = $port;
        $this->nessus_id    = $nessus_id;
	    $this->risk         = $risk;
	    $this->description  = $description;
    }

    function get_id()           { return $this->id;         }
    function get_incident_id()  { return $this->incident_id;}
    function get_ip()           { return $this->ip;         }
    function get_port()         { return $this->port;       }
    function get_nessus_id()    { return $this->nessus_id;  }
    function get_risk()         { return $this->risk;       }
    function get_description()  { return $this->description;}

    function get_list ($conn, $args)
    {
        $list = array();
        $query = OssimQuery("SELECT * FROM incident_vulns $args");
        if (!$rs = &$conn->Execute($query)) {
            print $conn->ErrorMsg();
        } else {
            while (!$rs->EOF) {
                $list[] = new Incident_vulnerability (
                                        $rs->fields["id"],
                                        $rs->fields["incident_id"],
                                        $rs->fields["ip"],
                                        $rs->fields["port"],
					                    $rs->fields["nessus_id"],
					                    $rs->fields["risk"],
                                        $rs->fields["description"]);
                $rs->MoveNext();
            }
        }
        return $list;
    }
}

?>
